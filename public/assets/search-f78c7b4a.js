import{_ as b,f as l,G as k,o as r,c as u,d,H as I,I as S,h as i,J as x,L,F as g,i as M,s as U,M as B,N as y,t as C,p as D,b as E}from"./index-f97316e7.js";import{m as F}from"./musicList-5cc4e3f5.js";import"./icon-1273f975.js";const H=c=>(D("data-v-7d0b6fc5"),c=c(),E(),c),K={class:"search-head"},N={class:"hot-search"},R=H(()=>d("span",null,"热门搜索：",-1)),V=["onClick"],q={key:1,class:"no-result"},G={__name:"search",setup(c){let a=l(""),h,n=l(!0),o=l([]),_=l([]);k().then(({result:t})=>{_.value=t.hots});function m(t){if(t===""){window.$tip("搜索内容不能为空！");return}h=t,a.value="",y(t).then(({result:s})=>{window.$tip(`共搜索到${s.songCount}条相关数据`),o.value=f(s.songs),s.hasMore?n.value=!0:n.value=!1})}function f(t){let s=[];for(let e of t)s.push({id:e.id,name:e.name,singer:e.artists[0].name,album:e.album.name,image:e.album.picUrl||"",duration:e.duration/1e3,url:`https://music.163.com/song/media/outer/url?id=${e.id}.mp3`});return s}async function w(t){try{let s=await B(t.id).then(p=>p.songs[0].al.picUrl);t.image=s;let e=`url(${s}?300y300)`;document.querySelector(".bg").style.backgroundImage=e}catch{window.$tip("封面加载出错啦！")}}let v=l(0);function $(){n.value&&(v.value+=1,y(h,v.value).then(({result:t})=>{o.value=o.value.concat(f(t.songs)),window.$tip(`共${t.songCount}条数据，已加载${o.value.length}条`),t.hasMore?n.value=!0:n.value=!1}))}return(t,s)=>(r(),u(g,null,[d("div",K,[I(d("input",{type:"text",placeholder:"搜一搜",class:"searchInput","onUpdate:modelValue":s[0]||(s[0]=e=>x(a)?a.value=e:a=e),autocomplete:"on",onKeydown:s[1]||(s[1]=L(e=>m(i(a)),["enter"]))},null,544),[[S,i(a),void 0,{trim:!0}]]),d("div",N,[R,(r(!0),u(g,null,M(i(_),(e,p)=>(r(),u("span",{key:p,class:"hotItem",onClick:J=>m(e.first)},C(e.first),9,V))),128))])]),i(o).length!==0?(r(),U(F,{key:0,onSelect:w,list:i(o),onScroll:$,scroll:!0},null,8,["list"])):(r(),u("div",q,"哎呦，什么都没有！快来搜索吧"))],64))}},A=b(G,[["__scopeId","data-v-7d0b6fc5"]]);export{A as default};
